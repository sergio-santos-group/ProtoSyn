<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>SeqDes model Â· ProtoSyn.jl</title><script data-outdated-warner src="../../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../../assets/documenter.js"></script><script src="../../../../siteinfo.js"></script><script src="../../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../../assets/themeswap.js"></script><link href="../../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../../"><img src="../../../../assets/logo.png" alt="ProtoSyn.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../../">ProtoSyn.jl</a></span></div><form class="docs-search" action="../../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../../../getting-started/installation/">Installation</a></li><li><a class="tocitem" href="../../../../getting-started/first-steps/">First steps</a></li><li><a class="tocitem" href="../../../../getting-started/examples/">Examples</a></li></ul></li><li><span class="tocitem">ProtoSyn API</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Core</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../core/types/">Types</a></li><li><input class="collapse-toggle" id="menuitem-3-1-2" type="checkbox"/><label class="tocitem" for="menuitem-3-1-2"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../core/methods/graph/">Graph</a></li><li><a class="tocitem" href="../../../core/methods/state/">State</a></li><li><a class="tocitem" href="../../../core/methods/pose/">Pose</a></li><li><a class="tocitem" href="../../../core/methods/io/">Input and Output (IO)</a></li><li><a class="tocitem" href="../../../core/methods/other/">Auxiliary methods</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-3" type="checkbox"/><label class="tocitem" for="menuitem-3-1-3"><span class="docs-label">Calculators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../core/calculators/calculators-section/">Calculators Section</a></li><li><a class="tocitem" href="../../../core/calculators/torchani/">TorchANI</a></li><li><a class="tocitem" href="../../../core/calculators/bond-distance-restraint/">Bond distance Restraint</a></li><li><a class="tocitem" href="../../../core/calculators/potential-restraints/">Potential Restraints</a></li><li><a class="tocitem" href="../../../core/calculators/electrostatics/">Electrostatics</a></li><li><a class="tocitem" href="../../../core/calculators/gb-solvation/">Generalized Born</a></li><li><a class="tocitem" href="../../../core/calculators/sasa/">SASA</a></li><li><a class="tocitem" href="../../../core/calculators/hydrogen-bonds/">Hydrogen Bonds</a></li><li><a class="tocitem" href="../../../core/calculators/radius-gyration/">Radius of gyration</a></li><li><a class="tocitem" href="../../../core/calculators/custom-ref-energy/">Custom reference energy</a></li><li><a class="tocitem" href="../../../core/calculators/ref15/">REF-15</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-4" type="checkbox"/><label class="tocitem" for="menuitem-3-1-4"><span class="docs-label">Mutators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../core/mutators/mutators-section/">Mutators Section</a></li><li><a class="tocitem" href="../../../core/mutators/mutators-dihedral/">Dihedral Mutator</a></li><li><a class="tocitem" href="../../../core/mutators/mutators-crankshaft/">Crankshaft Mutator</a></li><li><a class="tocitem" href="../../../core/mutators/mutators-rigid-body/">Rigid Body Mutators</a></li><li><a class="tocitem" href="../../../core/mutators/mutators-backrub/">Backrub Mutators</a></li><li><a class="tocitem" href="../../../core/mutators/mutators-compound/">Compound Mutators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-5" type="checkbox"/><label class="tocitem" for="menuitem-3-1-5"><span class="docs-label">Drivers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../core/drivers/drivers-section/">Drivers Section</a></li><li><a class="tocitem" href="../../../core/drivers/drivers-monte-carlo/">Monte Carlo</a></li><li><a class="tocitem" href="../../../core/drivers/drivers-steepest-descent/">Steepest Descent</a></li><li><a class="tocitem" href="../../../core/drivers/drivers-ils/">ILS</a></li><li><a class="tocitem" href="../../../core/drivers/drivers-compound/">Compound Driver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-1-6" type="checkbox"/><label class="tocitem" for="menuitem-3-1-6"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../core/submodules/selections/">Selections</a></li><li><a class="tocitem" href="../../../core/submodules/builder/">Builder</a></li><li><a class="tocitem" href="../../../core/submodules/external-packages/">External packages</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox" checked/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Peptides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../introduction/">Introduction</a></li><li><a class="tocitem" href="../../types/">Types</a></li><li><input class="collapse-toggle" id="menuitem-3-2-3" type="checkbox"/><label class="tocitem" for="menuitem-3-2-3"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../methods/io/">Input and Output (IO)</a></li><li><a class="tocitem" href="../../methods/graph/">Graph</a></li><li><a class="tocitem" href="../../methods/state/">State</a></li><li><a class="tocitem" href="../../methods/pose/">Pose</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-4" type="checkbox" checked/><label class="tocitem" for="menuitem-3-2-4"><span class="docs-label">Calculators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../potential-restraints/">Potential Restraints</a></li><li><a class="tocitem" href="../electrostatics/">Electrostatics</a></li><li><a class="tocitem" href="../sasa/">SASA</a></li><li><a class="tocitem" href="../natural-frequency/">Natural frequency</a></li><li><a class="tocitem" href="../ss-propensity/">Secondary structure propensity</a></li><li><a class="tocitem" href="../caterpillar-solvation/">Caterpilar solvation model</a></li><li class="is-active"><a class="tocitem" href>SeqDes model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-5" type="checkbox"/><label class="tocitem" for="menuitem-3-2-5"><span class="docs-label">Mutators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../mutators/rotamer/">Rotamer Mutator</a></li><li><a class="tocitem" href="../../mutators/design/">Design Mutator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-6" type="checkbox"/><label class="tocitem" for="menuitem-3-2-6"><span class="docs-label">Drivers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../drivers/rotamer-blitz-driver/">Rotamer Blitz</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2-7" type="checkbox"/><label class="tocitem" for="menuitem-3-2-7"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../submodules/selections/">Selections</a></li><li><a class="tocitem" href="../../submodules/builder/">Builder</a></li><li><a class="tocitem" href="../../submodules/rotamers/">Rotamers</a></li><li><a class="tocitem" href="../../submodules/external-packages/">External packages</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Materials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../materials/introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-3-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-3-2"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../materials/methods/lattices/">Lattices</a></li><li><a class="tocitem" href="../../../materials/methods/carbons/">Carbons</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Sugars</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../sugars/introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-3-4-2" type="checkbox"/><label class="tocitem" for="menuitem-3-4-2"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../sugars/submodules/builder/">Builder</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../common/introduction/">Introduction</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">ProtoSyn API</a></li><li><a class="is-disabled">Peptides</a></li><li><a class="is-disabled">Calculators</a></li><li class="is-active"><a href>SeqDes model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>SeqDes model</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/master/docs/src/protosyn-api/peptides/calculators/seqdes.md" title="Edit on GitHub"><span class="docs-icon fab">ï</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="SeqDes-model"><a class="docs-heading-anchor" href="#SeqDes-model">SeqDes model</a><a id="SeqDes-model-1"></a><a class="docs-heading-anchor-permalink" href="#SeqDes-model" title="Permalink"></a></h1><p>The <a href="#SeqDes-model">SeqDes model</a> Calcualtors module introduces the possibility to employ part of the work by Huang et al. (see <a href="https://www.nature.com/articles/s41467-022-28313-9">this paper</a>) in ProtoSyn. The <a href="#SeqDes-model">SeqDes model</a>, in sum, evaluates the current sequence and chi dihedrals in accordance to a trained model on many natural proteins (but generalizable to de novo sequences).</p><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.Peptides.Calculators.SeqDes.get_pdb_data" href="#ProtoSyn.Peptides.Calculators.SeqDes.get_pdb_data"><code>ProtoSyn.Peptides.Calculators.SeqDes.get_pdb_data</code></a> â <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_pdb_data(pose::Pose, selection::Opt{AbstractSelection} = nothing)</code></pre><p>Returns all PDB data necessary for <a href="#ProtoSyn.Peptides.Calculators.SeqDes.calc_seqdes"><code>calc_seqdes</code></a> from the given <a href="../../../core/types/#ProtoSyn.Pose"><code>Pose</code></a> <code>pose</code>. If an <code>AbstractSelection</code> <code>selection</code> is provided, consider only the selected <a href="../../../core/types/#ProtoSyn.Atom"><code>Atom</code></a> instances (for <a href="../../../core/types/#ProtoSyn.Residue"><code>Residue</code></a> level data, since the <code>selection</code> is promoted, any <a href="../../../core/types/#ProtoSyn.Residue"><code>Residue</code></a> with at least 1 selected <a href="../../../core/types/#ProtoSyn.Atom"><code>Atom</code></a> is considered).</p><p>Should return:</p><ul><li>atom_coords: N x 3 Vector (atomic positions)</li><li>atom_data: N x 4 Vector(atomic data):<ul><li>[residue_id, bb_ind, atom_type, residue_type], where <code>residue_id</code> is 0-indexed; <code>bb_ind</code> is either 1 or 0, if the corresponding atom is in the protein backbone or not, respectively; <code>atom_type</code> is the index of the atom element in the <code>Calculators.SeqDes.atom_types</code> dictionary; and <code>residue_type</code> is the index of the residue type in the  <code>Calculators.SeqDes.residue_types</code> dictionary.</li></ul></li><li>residue_bb_index: Nr x 4 (atomic index of all backbone atoms + CB)<ul><li>[N, CA, C, CB], where all atomic indexes are 0-indexed; for residues without CB, the -1 index is used.</li></ul></li><li>residue_data: Dict(&#39;chain_code&#39; =&gt; Nr x 4) (residue data)<ul><li>[residue_id, residue_id_code, residue_index, residue_type], where <code>residue_id_code</code> can be ignored and set to &#39; &#39;, <code>residue_index</code> is 0-indexed and <code>residue_type</code> is the index of the residue type in the <code>Calculators.SeqDes.residue_types</code> dictionary.</li></ul></li><li>residue_label: Nr x 1 (list of residue types)</li><li>chis: Nr x 2 x 4 (chi dihedral angle values)<ul><li>[[chi1_v, chi2_v, chi3_v, chi4_v], [chi1, chi2, chi3, chi4]], where <code>chi1_v</code>, <code>chi2_v</code>, etc is the actual dihedral value (in a 4 element array) and <code>chi1</code>, <code>chi2</code>, etc is either 1 or 0, if the corresponding chi dihedral exists or nor, respectively.</li></ul></li></ul><div class="admonition is-category-ukw"><header class="admonition-header">Note:</header><div class="admonition-body"><p><code>N</code> is the number of atoms and <code>Nr</code> is the number of residues. Hydrogens (with symbol H) are always ignored.</p></div></div><p><strong>See also</strong></p><p><a href="#ProtoSyn.Peptides.Calculators.SeqDes.calc_seqdes"><code>calc_seqdes</code></a></p><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">julia&gt; ProtoSyn.Peptides.Calculators.SeqDes.get_pdb_data(pose)
(...)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/44bd8c41a3aa181671371c48227125b5b12149b7/src/Peptides/Calculators/seq_des.jl#L141-L187">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.Peptides.Calculators.SeqDes.calc_seqdes" href="#ProtoSyn.Peptides.Calculators.SeqDes.calc_seqdes"><code>ProtoSyn.Peptides.Calculators.SeqDes.calc_seqdes</code></a> â <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calc_seqdes([::Type{ProtoSyn.CUDA_2}], pose::Pose, selection::Opt{AbstractSelection}, [update_forces::Bool = false]; [use_cuda::Bool = true])</code></pre><p>Calculates the <a href="../../../core/types/#ProtoSyn.Pose"><code>Pose</code></a> <code>pose</code> energy in accordance to the SeqDes machine learning model (see https://www.nature.com/articles/s41467-022-28313-9). In sum, this model evaluates the current sequence and chi dihedrals in accordance to a trained model on many natural proteins (but generalizable). If an <code>AbstractSelection</code> <code>selection</code> is given, only the selected <a href="../../../core/types/#ProtoSyn.Atom"><code>Atom</code></a> instances are considered for the energy calculation. This method does not calculate forces. As such, the <code>update_forces</code> flag has no effect and serves only for standardization purposes between <code>Calculators</code> methods. Currently, this method requires the usage of <code>ProtoSyn.CUDA_2</code> acceleration type (and setting the <code>use_cuda</code> flag to <code>true</code>). Returns the energy value, nothing (forces), energy per residue and the calculated logits. Note that the calculated logits can be employed in the SeqDes ML model to retrieve rotamers according to the model. Both the energy per residue and logits are returned as PyObject tensors.</p><p><strong>See also</strong></p><p><a href="#ProtoSyn.Peptides.Calculators.SeqDes.get_default_seqdes"><code>get_default_seqdes</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; ProtoSyn.Peptides.Calculators.SeqDes.calc_seqdes(pose, nothing)
(13.240120887756348, nothing, PyObject tensor(...), PyObject tensor(...))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/44bd8c41a3aa181671371c48227125b5b12149b7/src/Peptides/Calculators/seq_des.jl#L311-L337">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ProtoSyn.Peptides.Calculators.SeqDes.get_default_seqdes" href="#ProtoSyn.Peptides.Calculators.SeqDes.get_default_seqdes"><code>ProtoSyn.Peptides.Calculators.SeqDes.get_default_seqdes</code></a> â <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_default_seqdes(;[Î±::T = 1.0]) where {T &lt;: AbstractFloat}</code></pre><p>Return the default SeqDes energy <a href="../../../core/calculators/calculators-section/#ProtoSyn.Calculators.EnergyFunctionComponent"><code>EnergyFunctionComponent</code></a>. <code>Î±</code> sets the component weight (on an <a href="../../../core/calculators/calculators-section/#ProtoSyn.Calculators.EnergyFunction"><code>EnergyFunction</code></a> instance, <code>1.0</code> by default). This function employs <a href="#ProtoSyn.Peptides.Calculators.SeqDes.calc_seqdes"><code>calc_seqdes</code></a> as the <code>:calc</code> function.</p><p><strong>Settings</strong></p><ul><li><code>use_cuda::Bool</code> - Whether to use CUDA acceleration type. Currently, this <a href="../../../core/calculators/calculators-section/#ProtoSyn.Calculators.EnergyFunctionComponent"><code>EnergyFunctionComponent</code></a> requires <code>use_cuda</code> to be <code>true</code>.</li></ul><p><strong>See also</strong></p><p><a href="#ProtoSyn.Peptides.Calculators.SeqDes.calc_seqdes"><code>calc_seqdes</code></a></p><p><strong>Examples</strong></p><p>```jldoctest julia&gt; ProtoSyn.Peptides.Calculators.SeqDes.get<em>default</em>seqdes() ð§  Energy Function Component: +âââââââââââââââââââââââââ-+ | Name           | SeqDes<em>ML</em>Model                  | | Alpha (Î±)      | 1.0                              | | Update forces  | false                            | | Calculator     | calc<em>seqdes                      | +âââââââââââââââââââââââââ-+ |    +âââââââââââââââââââââââââââââââââââââââââ+ âââ  â Settings                      | Value                                            | |    +âââââââââââââââââââââââââââââââââââââââââ+ |    | use</em>cuda                      | true                                             | |    +âââââââââââââââââââââââââââââââââââââââââ+ |     âââ  â  Selection: nothing</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sergio-santos-group/ProtoSyn.jl/blob/44bd8c41a3aa181671371c48227125b5b12149b7/src/Peptides/Calculators/seq_des.jl#L383-L416">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../caterpillar-solvation/">Â« Caterpilar solvation model</a><a class="docs-footer-nextpage" href="../../mutators/rotamer/">Rotamer Mutator Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Tuesday 16 August 2022 14:09">Tuesday 16 August 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
